<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>HTML5 script 标签的 crossorigin 和integrity属性的作用 - F.X</title><meta name="description" content="Bootstrap 4 依赖的基础库中出现了两个新的属性
1231 &amp;lt;script src&amp;#x3D;&amp;quot;https:&amp;#x2F;&amp;#x2F;cdn.bootcss.com&amp;#x2F;jquery&amp;#x2F;3.2.1&amp;#x2F;jquery.slim.min.js&amp;quot; int"><meta name="author" content="FXX"><meta property="og:title" content="HTML5 script 标签的 crossorigin 和integrity属性的作用"><meta property="og:site_name" content="F.X"><link rel="stylesheet" href="/css/bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css"><link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.min.css"><link href="css/googlefonts.css" rel="stylesheet"><link rel="stylesheet" href="/css/styles.css"><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]--><meta name="generator" content="Hexo 5.3.0"></head><body><div class="container my-4"><nav class="navbar navbar-toggleable-sm navbar-light px-1 py-3 my-3 mb-sm-3"><a class="navbar-brand ml-2" href="/"><span class="title">F.X</span></a> <button class="navbar-toggler navbar-toggler-right py-2" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse text-center mt-3 mt-md-0" id="navbarCollapse"><ul class="navbar-nav ml-auto my-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href="https://xueli.li">Xueli.li</a></li></ul><hr class="hidden-md-up"></div></nav></div><div class="container"><div class="row"><div class="col-12"><img class="img-fluid cover-image" src="/images/init.jpg" alt="HTML5 script 标签的 crossorigin 和integrity属性的作用"></div></div><div class="row"><div class="col-12 col-lg-8 offset-lg-2 mt-4"><div class="post-page text-center my-4"><h1>HTML5 script 标签的 crossorigin 和integrity属性的作用</h1><hr><span class="date">2020-12-28</span></div><p><a target="_blank" rel="noopener" href="https://getbootstrap.com/">Bootstrap 4</a> 依赖的基础库中出现了两个新的属性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;jquery&#x2F;3.2.1&#x2F;jquery.slim.min.js&quot; integrity&#x3D;&quot;sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr&#x2F;rE9&#x2F;Qpg6aAZGJwFDMVNA&#x2F;GpGFF93hXpG5KkN&quot; crossorigin&#x3D;&quot;anonymous&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">2 &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;popper.js&#x2F;1.12.9&#x2F;umd&#x2F;popper.min.js&quot; integrity&#x3D;&quot;sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K&#x2F;ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q&quot; crossorigin&#x3D;&quot;anonymous&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">3 &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;bootstrap&#x2F;4.0.0&#x2F;js&#x2F;bootstrap.min.js&quot; integrity&#x3D;&quot;sha384-JZR6Spejh4U02d8jOt6vLEHfe&#x2F;JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl&quot; crossorigin&#x3D;&quot;anonymous&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>HTML5 新的规定，是可以允许本地获取到跨域脚本的错误信息，但有两个条件：一是跨域脚本的服务器必须通过 <code>Access-Controll-Allow-Origin</code> 头信息允许当前域名可以获取错误信息，二是当前域名的 script 标签也必须指明 <code>src</code> 属性指定的地址是支持跨域的地址，也就是 crossorigin 属性。听名字也知道是跨域的时候用的属性，加载本地静态文件根本就不牵涉跨域的问题，所以本地就不应该用它（理论上使用也没关系，但浏览器就是这么定的，印象中如果 crossorigin 用在了本地文件上，浏览器报错信息会告诉你 crossorigin 只能支持 http/https/… 等协议上，所以你非要加载本地静态文件也不是没办法，只能自建本地 web 服务器然后地址写带 scheme 和 host 的完全绝对路径）。</p><p>另外除了 script ，所有能引入跨域资源的标签包括 link 和 img 之类，都有一样的属性。</p><p>integrity （大部分情况）是给 CDN 的静态文件使用的，比如大名鼎鼎的 ajax.googleapis.com，或者国内的 cdn.bootcss.com。CDN虽然好但 CDN 有可能被劫持，导致下载的文件是被篡改过的（比如通过 DNS 劫持），有了 integrity 就可以检查文件是否是原版。但因为本地文件用的域名跟网页是同一个域名，不存在劫持的问题（或者劫持就连网站本身一起被劫持了，那就不是 integrity 能解决的问题了），所以本地静态文件没有太大必要用这个属性。</p><p>当然，还有一种情况是你自己搭了一套提供静态文件的独立站点，这个时候用 integrity 是有意义。MDN 文档里也提到了 integrity 值的生成方式，这里也再引用一下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 cat FILENAME.js | openssl dgst -sha384 -binary | openssl base64 -A</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 shasum -b -a 384 FILENAME.js | awk &#39;&#123; print $1 &#125;&#39; | xxd -r -p | base64</span><br></pre></td></tr></table></figure><p>总之简单一句话：只有当你的网页域名和要载入的静态文件存放的站点域名不一样的时候，使用这两个属性才有意义（并且因浏览器的规定 crossorigin 属性只有这个时候才能正常使用）</p></div></div><footer class="text-center mt-5 py-5"><a href="https://twitter.com/?lang=en" target="_blank"><i class="fa fa-twitter mr-4"></i></a> <a href="https://www.facebook.com/" target="_blank"><i class="fa fa-facebook mr-4"></i></a> <a href="https://www.instagram.com/" target="_blank"><i class="fa fa-instagram mr-4"></i></a> <a href="https://www.linkedin.com/" target="_blank"><i class="fa fa-linkedin mr-4"></i></a></footer></div><script src="/js/jquery-3.1.1.slim.min.js"></script><script src="/js/tether.min.js"></script><script src="/js/bootstrap.min.js"></script></body></html>